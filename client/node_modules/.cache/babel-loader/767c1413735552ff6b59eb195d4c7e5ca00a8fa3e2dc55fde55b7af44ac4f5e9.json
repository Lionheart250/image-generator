{"ast":null,"code":"var _jsxFileName = \"/Users/jack/image-generator/client/src/pages/Settings.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport './Settings.css';\nimport { useProfile } from '../context/ProfileContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Settings = () => {\n  _s();\n  const {\n    profilePicture,\n    setProfilePicture\n  } = useProfile();\n  const [loading, setLoading] = useState(false);\n  const [message, setMessage] = useState('');\n  const [tempProfilePicture, setTempProfilePicture] = useState(null);\n  const [profilePictureFile, setProfilePictureFile] = useState(null);\n\n  // Fetch initial profile picture\n  useEffect(() => {\n    const fetchProfilePicture = async () => {\n      try {\n        const response = await fetch('http://localhost:3000/profile_picture', {\n          headers: {\n            'Authorization': `Bearer ${localStorage.getItem('token')}`\n          }\n        });\n        if (response.ok) {\n          const data = await response.json();\n          if (data.profile_picture) {\n            // Make sure to access the correct field\n            setProfilePicture(`http://localhost:3000/${data.profile_picture}`);\n          }\n        } else {\n          throw new Error(`Failed to fetch: ${response.statusText}`);\n        }\n      } catch (error) {\n        console.error('Error fetching profile picture:', error);\n      }\n    };\n    fetchProfilePicture();\n  }, []);\n  const handleProfilePictureChange = async e => {\n    const file = e.target.files[0];\n    if (file) {\n      setProfilePictureFile(file);\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        setTempProfilePicture(reader.result);\n      };\n      reader.readAsDataURL(file);\n    }\n  };\n  const handleSubmit = async e => {\n    e.preventDefault();\n    setLoading(true);\n    setMessage('');\n    try {\n      const token = localStorage.getItem('token');\n      const formData = new FormData();\n      if (profilePictureFile) {\n        formData.append('image', profilePictureFile);\n        const response = await fetch('http://localhost:3000/upload_profile_picture', {\n          method: 'POST',\n          headers: {\n            'Authorization': `Bearer ${token}`\n          },\n          body: formData\n        });\n        const data = await response.json();\n        if (!response.ok) {\n          throw new Error(data.error || 'Failed to upload profile picture');\n        }\n        setProfilePicture(`http://localhost:3000/${data.profilePicturePath}`);\n      }\n      setMessage('Profile updated successfully');\n    } catch (error) {\n      console.error('Profile update error:', error);\n      setMessage(error.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"settings-container\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"settings-content\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Settings\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"settings-section\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"profile-picture-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: tempProfilePicture || profilePicture,\n            alt: \"Profile\",\n            className: \"settings-profile-picture\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"file\",\n            id: \"profile-picture-input\",\n            accept: \"image/*\",\n            onChange: handleProfilePictureChange,\n            style: {\n              display: 'none'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 98,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"profile-picture-input\",\n            className: \"profile-picture-change-btn\",\n            children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n              viewBox: \"0 0 24 24\",\n              children: [/*#__PURE__*/_jsxDEV(\"path\", {\n                d: \"M12 16.5a4.5 4.5 0 100-9 4.5 4.5 0 000 9zm0-2.5a2 2 0 100-4 2 2 0 000 4z\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 110,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n                d: \"M20 4h-3.17L15 2H9L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 14H4V6h4.05l1.83-2h4.24l1.83 2H20v12z\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 111,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 109,\n              columnNumber: 29\n            }, this), \"Change photo\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 105,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"settings-actions\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"settings-save-btn\",\n            onClick: handleSubmit,\n            disabled: loading,\n            children: loading ? 'Saving...' : 'Save Changes'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 117,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 21\n        }, this), message && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"settings-message\",\n          children: message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 88,\n    columnNumber: 9\n  }, this);\n};\n_s(Settings, \"ZDwJb7NEB7AL+voEoNMzcuiR3rg=\", false, function () {\n  return [useProfile];\n});\n_c = Settings;\nexport default Settings;\nvar _c;\n$RefreshReg$(_c, \"Settings\");","map":{"version":3,"names":["React","useState","useEffect","useProfile","jsxDEV","_jsxDEV","Settings","_s","profilePicture","setProfilePicture","loading","setLoading","message","setMessage","tempProfilePicture","setTempProfilePicture","profilePictureFile","setProfilePictureFile","fetchProfilePicture","response","fetch","headers","localStorage","getItem","ok","data","json","profile_picture","Error","statusText","error","console","handleProfilePictureChange","e","file","target","files","reader","FileReader","onloadend","result","readAsDataURL","handleSubmit","preventDefault","token","formData","FormData","append","method","body","profilePicturePath","className","children","fileName","_jsxFileName","lineNumber","columnNumber","src","alt","type","id","accept","onChange","style","display","htmlFor","viewBox","d","onClick","disabled","_c","$RefreshReg$"],"sources":["/Users/jack/image-generator/client/src/pages/Settings.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport './Settings.css';\nimport { useProfile } from '../context/ProfileContext';\n\nconst Settings = () => {\n    const { profilePicture, setProfilePicture } = useProfile();\n    const [loading, setLoading] = useState(false);\n    const [message, setMessage] = useState('');\n    const [tempProfilePicture, setTempProfilePicture] = useState(null);\n    const [profilePictureFile, setProfilePictureFile] = useState(null);\n\n    // Fetch initial profile picture\n    useEffect(() => {\n        const fetchProfilePicture = async () => {\n            try {\n                const response = await fetch('http://localhost:3000/profile_picture', {\n                    headers: {\n                        'Authorization': `Bearer ${localStorage.getItem('token')}`\n                    }\n                });\n                if (response.ok) {\n                    const data = await response.json();\n                    if (data.profile_picture) { // Make sure to access the correct field\n                        setProfilePicture(`http://localhost:3000/${data.profile_picture}`);\n                    }\n                } else {\n                    throw new Error(`Failed to fetch: ${response.statusText}`);\n                }\n            } catch (error) {\n                console.error('Error fetching profile picture:', error);\n            }\n        };\n\n        fetchProfilePicture();\n    }, []);\n\n    const handleProfilePictureChange = async (e) => {\n        const file = e.target.files[0];\n        if (file) {\n            setProfilePictureFile(file);\n            const reader = new FileReader();\n            reader.onloadend = () => {\n                setTempProfilePicture(reader.result);\n            };\n            reader.readAsDataURL(file);\n        }\n    };\n\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n        setLoading(true);\n        setMessage('');\n\n        try {\n            const token = localStorage.getItem('token');\n            const formData = new FormData();\n            \n            if (profilePictureFile) {\n                formData.append('image', profilePictureFile);\n                \n                const response = await fetch('http://localhost:3000/upload_profile_picture', {\n                    method: 'POST',\n                    headers: {\n                        'Authorization': `Bearer ${token}`\n                    },\n                    body: formData\n                });\n\n                const data = await response.json();\n                \n                if (!response.ok) {\n                    throw new Error(data.error || 'Failed to upload profile picture');\n                }\n\n                setProfilePicture(`http://localhost:3000/${data.profilePicturePath}`);\n            }\n\n            setMessage('Profile updated successfully');\n        } catch (error) {\n            console.error('Profile update error:', error);\n            setMessage(error.message);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    return (\n        <div className=\"settings-container\">\n            <div className=\"settings-content\">\n                <h2>Settings</h2>\n                <div className=\"settings-section\">\n                    <div className=\"profile-picture-section\">\n                        <img \n                            src={tempProfilePicture || profilePicture} \n                            alt=\"Profile\" \n                            className=\"settings-profile-picture\" \n                        />\n                        <input\n                            type=\"file\"\n                            id=\"profile-picture-input\"\n                            accept=\"image/*\"\n                            onChange={handleProfilePictureChange}\n                            style={{ display: 'none' }}\n                        />\n                        <label \n                            htmlFor=\"profile-picture-input\" \n                            className=\"profile-picture-change-btn\"\n                        >\n                            <svg viewBox=\"0 0 24 24\">\n                                <path d=\"M12 16.5a4.5 4.5 0 100-9 4.5 4.5 0 000 9zm0-2.5a2 2 0 100-4 2 2 0 000 4z\"/>\n                                <path d=\"M20 4h-3.17L15 2H9L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 14H4V6h4.05l1.83-2h4.24l1.83 2H20v12z\"/>\n                            </svg>\n                            Change photo\n                        </label>\n                    </div>\n                    <div className=\"settings-actions\">\n                        <button \n                            className=\"settings-save-btn\"\n                            onClick={handleSubmit}\n                            disabled={loading}\n                        >\n                            {loading ? 'Saving...' : 'Save Changes'}\n                        </button>\n                    </div>\n                    {message && (\n                        <div className=\"settings-message\">\n                            {message}\n                        </div>\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default Settings;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}