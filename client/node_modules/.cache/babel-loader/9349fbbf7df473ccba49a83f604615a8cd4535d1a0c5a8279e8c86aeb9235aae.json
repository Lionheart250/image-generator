{"ast":null,"code":"var _jsxFileName = \"/Users/jack/image-generator/client/src/pages/Profile.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { jwtDecode } from 'jwt-decode'; // Ensure jwt-decode is installed\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { useAuth } from '../context/AuthContext';\nimport { useProfile } from '../context/ProfileContext';\nimport debounce from 'lodash.debounce';\nimport './Profile.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Profile = () => {\n  _s();\n  var _images$find;\n  const {\n    id\n  } = useParams();\n  const {\n    user\n  } = useAuth();\n  const {\n    profilePicture,\n    setProfilePicture\n  } = useProfile();\n  const [username, setUsername] = useState('');\n  const [bio, setBio] = useState('');\n  const [posts, setPosts] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [message, setMessage] = useState('');\n  const [isEditing, setIsEditing] = useState(false);\n  const [images, setImages] = useState([]);\n  const [modalImage, setModalImage] = useState(null);\n  const [activeImageId, setActiveImageId] = useState(null);\n  const [likes, setLikes] = useState({});\n  const [comments, setComments] = useState({});\n  const [commentInput, setCommentInput] = useState('');\n  const [userLikedImages, setUserLikedImages] = useState(new Set());\n  const [commentLikes, setCommentLikes] = useState({});\n  const [modalOpen, setModalOpen] = useState(false);\n  const [tempUsername, setTempUsername] = useState('');\n  const [tempBio, setTempBio] = useState('');\n  const [tempProfilePicture, setTempProfilePicture] = useState(null);\n  const [profilePictureFile, setProfilePictureFile] = useState(null);\n  const navigate = useNavigate();\n  const [isLoading, setIsLoading] = useState(true);\n  const [file, setFile] = useState(null);\n  const debouncedOpenModal = useCallback(debounce(image => {\n    console.log('Opening modal for image ID:', image.id);\n    setModalImage(image); // Add this line\n    setActiveImageId(image.id);\n    setModalOpen(true);\n    fetchImageDetails(image.id);\n  }, 300), []);\n\n  // Add debug logs\n  useEffect(() => {\n    console.log('Modal state:', {\n      modalOpen,\n      modalImage,\n      activeImageId\n    });\n  }, [modalOpen, modalImage, activeImageId]);\n  useEffect(() => {\n    // Fetch user bio and posts\n    fetchUserProfile();\n  }, [id]);\n  useEffect(() => {\n    // Initialize temp values when entering edit mode\n    if (isEditing) {\n      setTempUsername(username);\n      setTempBio(bio);\n      setTempProfilePicture(profilePicture);\n      setProfilePictureFile(null);\n      setMessage(''); // Clear message when opening modal\n    }\n  }, [isEditing]);\n  useEffect(() => {\n    const fetchUserImages = async () => {\n      try {\n        const token = localStorage.getItem('token');\n        const loggedInUserId = localStorage.getItem('userId');\n\n        // If viewing own profile use localStorage userId, otherwise use URL id\n        const targetUserId = id === loggedInUserId ? loggedInUserId : id;\n        console.log('Fetching images for user:', targetUserId);\n        const response = await fetch(`http://localhost:3000/user_images/${targetUserId}`, {\n          headers: {\n            'Authorization': `Bearer ${token}`\n          }\n        });\n        if (!response.ok) {\n          throw new Error(`HTTP error! status: ${response.status}`);\n        }\n        const data = await response.json();\n        console.log('Received images:', data);\n        setImages(data.images || []);\n      } catch (error) {\n        console.error('Error fetching images:', error);\n      }\n    };\n    fetchUserImages();\n  }, [id]); // Add id as dependency to re-fetch when URL changes\n\n  const fetchUserProfile = async () => {\n    if (!id) return;\n    try {\n      console.log('Starting profile fetch for ID:', id);\n      const token = localStorage.getItem('token');\n      const response = await fetch(`http://localhost:3000/user_profile/${id}`, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      const data = await response.json();\n      console.log('Profile data received:', data);\n      setUsername(data.username);\n      setBio(data.bio || '');\n\n      // Standardize URL construction\n      if (data.profile_picture) {\n        const baseUrl = 'http://localhost:3000';\n        const picturePath = data.profile_picture.startsWith('/') ? data.profile_picture : `/${data.profile_picture}`;\n        const profilePicUrl = `${baseUrl}${picturePath}`;\n        console.log('Constructed profile picture URL:', profilePicUrl);\n        console.log('Does file exist at path:', data.profile_picture);\n        setProfilePicture(profilePicUrl);\n      }\n    } catch (error) {\n      console.error('Error fetching profile:', error);\n      setProfilePicture('/default-avatar.png');\n    }\n  };\n  const fetchImageDetails = async imageId => {\n    const token = localStorage.getItem('token');\n    if (!token) return;\n    try {\n      const likeResponse = await fetch(`http://localhost:3000/fetch_likes?id=${imageId}`, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      if (likeResponse.ok) {\n        const likeData = await likeResponse.json();\n        setLikes(prev => ({\n          ...prev,\n          [imageId]: likeData.likes || 0\n        }));\n        if (likeData.userHasLiked) {\n          setUserLikedImages(prev => new Set(prev).add(imageId));\n        }\n      }\n      const commentResponse = await fetch(`http://localhost:3000/fetch_comments?id=${imageId}`, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      if (commentResponse.ok) {\n        const commentData = await commentResponse.json();\n        // Comments should now include profile_picture from backend\n        setComments(prev => ({\n          ...prev,\n          [imageId]: commentData.comments || []\n        }));\n      }\n    } catch (error) {\n      console.error('Error fetching image details:', error);\n    }\n  };\n  const handleProfilePictureChange = async e => {\n    const file = e.target.files[0];\n    if (file) {\n      setProfilePictureFile(file);\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        setTempProfilePicture(reader.result);\n      };\n      reader.readAsDataURL(file);\n    }\n  };\n  const handleSubmit = async e => {\n    e.preventDefault();\n    setLoading(true);\n    setMessage('');\n    try {\n      const token = localStorage.getItem('token');\n      const response = await fetch('http://localhost:3000/update_profile', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${token}`\n        },\n        body: JSON.stringify({\n          username: tempUsername,\n          bio: tempBio\n        })\n      });\n      const data = await response.json();\n      console.log('Server response:', data);\n      if (!response.ok) {\n        throw new Error(data.error || 'Failed to update profile');\n      }\n      setUsername(data.data.username);\n      setBio(data.data.bio || '');\n      if (profilePictureFile) {\n        const formData = new FormData();\n        formData.append('image', profilePictureFile);\n        const picResponse = await fetch('http://localhost:3000/upload_profile_picture', {\n          method: 'POST',\n          headers: {\n            'Authorization': `Bearer ${token}`\n          },\n          body: formData\n        });\n        const picData = await picResponse.json();\n        if (!picResponse.ok) {\n          throw new Error(picData.error || 'Failed to upload profile picture');\n        }\n        setProfilePicture(`http://localhost:3000/${picData.profilePicturePath}`);\n      }\n\n      // Confirm changes from DB\n      await fetchUserProfile();\n      setIsEditing(false);\n      setMessage('Profile updated successfully');\n    } catch (error) {\n      console.error('Profile update error:', error);\n      setMessage(error.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const handleCommentLike = async commentId => {\n    const token = localStorage.getItem('token');\n    if (!token) return;\n    try {\n      const response = await fetch('http://localhost:3000/like_comment', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${token}`\n        },\n        body: JSON.stringify({\n          commentId\n        })\n      });\n      if (response.ok) {\n        setCommentLikes(prev => ({\n          ...prev,\n          [commentId]: !prev[commentId]\n        }));\n      }\n    } catch (error) {\n      console.error('Error liking comment:', error);\n    }\n  };\n\n  // Update comment state when adding new comment\n  const handleCommentSubmit = async e => {\n    e.preventDefault();\n    const token = localStorage.getItem('token');\n    if (!token) return;\n    try {\n      const decoded = jwtDecode(token);\n      const userId = decoded.userId;\n\n      // Post the new comment\n      const response = await fetch('http://localhost:3000/add_comment', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${token}`\n        },\n        body: JSON.stringify({\n          userId,\n          imageId: activeImageId,\n          comment: commentInput\n        })\n      });\n      if (response.ok) {\n        // After adding the comment, fetch all comments again\n        const commentsResponse = await fetch(`http://localhost:3000/fetch_comments?id=${activeImageId}`, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        if (commentsResponse.ok) {\n          const commentsData = await commentsResponse.json();\n          // Update comments state with the latest comments\n          setComments(prev => ({\n            ...prev,\n            [activeImageId]: commentsData.comments // Use the fetched comments\n          }));\n          setCommentInput(''); // Clear the comment input\n        } else {\n          console.error('Error fetching comments:', await commentsResponse.json());\n        }\n      } else {\n        console.error('Error adding comment:', await response.json());\n      }\n    } catch (error) {\n      console.error('Error adding comment:', error);\n    }\n  };\n  const closeModal = () => {\n    setModalOpen(false);\n    setModalImage(null);\n    setActiveImageId(null);\n  };\n  const navigateImage = direction => {\n    const currentIndex = images.findIndex(img => img.id === activeImageId);\n    const newIndex = (currentIndex + direction + images.length) % images.length;\n    setActiveImageId(images[newIndex].id);\n    setModalImage(images[newIndex]);\n    fetchImageDetails(images[newIndex].id);\n  };\n  const isAdmin = user && user.role === 'admin';\n  const handleDeleteImage = async () => {\n    const token = localStorage.getItem('token');\n    if (!token) return;\n    try {\n      const response = await fetch(`http://localhost:3000/delete_image/${activeImageId}`, {\n        method: 'DELETE',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      if (response.ok) {\n        setImages(images.filter(img => img.id !== activeImageId));\n        closeModal();\n      } else {\n        console.error('Failed to delete image');\n      }\n    } catch (error) {\n      console.error('Error deleting image:', error);\n    }\n  };\n  const handleLike = async () => {\n    const token = localStorage.getItem('token');\n    if (!token) return;\n    const userId = jwtDecode(token).userId;\n    const hasLiked = userLikedImages.has(activeImageId);\n    try {\n      const response = hasLiked ? await fetch('http://localhost:3000/remove_like', {\n        method: 'DELETE',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${token}`\n        },\n        body: JSON.stringify({\n          userId,\n          imageId: activeImageId\n        })\n      }) : await fetch('http://localhost:3000/add_like', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${token}`\n        },\n        body: JSON.stringify({\n          userId,\n          imageId: activeImageId\n        })\n      });\n      if (response.ok) {\n        if (hasLiked) {\n          setLikes(prev => ({\n            ...prev,\n            [activeImageId]: (prev[activeImageId] || 0) - 1\n          }));\n          setUserLikedImages(prev => {\n            const newSet = new Set(prev);\n            newSet.delete(activeImageId);\n            return newSet;\n          });\n        } else {\n          setLikes(prev => ({\n            ...prev,\n            [activeImageId]: (prev[activeImageId] || 0) + 1\n          }));\n          setUserLikedImages(prev => new Set(prev).add(activeImageId));\n        }\n      }\n    } catch (error) {\n      console.error('Error toggling like:', error);\n    }\n  };\n  const formatTimestamp = timestamp => {\n    const date = new Date(timestamp);\n    return date.toLocaleString();\n  };\n\n  // Add handler function\n  const handleUsernameClick = user_id => {\n    setModalImage(null); // Close modal\n    setModalOpen(false); // Reset modal state\n    navigate(`/profile/${user_id}`);\n  };\n  const constructProfilePicUrl = path => {\n    if (!path) return '/default-avatar.png';\n    const baseUrl = 'http://localhost:3000';\n    const picturePath = path.startsWith('/') ? path : `/${path}`;\n    return `${baseUrl}${picturePath}`;\n  };\n\n  // Add loading state\n  useEffect(() => {\n    let isMounted = true;\n    const fetchUserProfile = async () => {\n      if (!id) return;\n      try {\n        setIsLoading(true);\n        const token = localStorage.getItem('token');\n        const response = await fetch(`http://localhost:3000/user_profile/${id}`, {\n          headers: {\n            'Authorization': `Bearer ${token}`\n          }\n        });\n        const data = await response.json();\n        console.log('Profile data received:', data);\n        if (!isMounted) return;\n        setUsername(data.username);\n        setBio(data.bio || '');\n        const profilePicUrl = constructProfilePicUrl(data.profile_picture);\n        console.log('Setting final profile picture URL:', profilePicUrl);\n        setProfilePicture(profilePicUrl);\n      } catch (error) {\n        console.error('Error fetching profile:', error);\n        if (isMounted) setProfilePicture('/default-avatar.png');\n      } finally {\n        if (isMounted) setIsLoading(false);\n      }\n    };\n    fetchUserProfile();\n    return () => {\n      isMounted = false;\n    };\n  }, [id]);\n  const handleFileChange = e => {\n    setFile(e.target.files[0]);\n  };\n  const handleUpload = async () => {\n    if (!file) {\n      setMessage('Please select a file to upload.');\n      return;\n    }\n    const formData = new FormData();\n    formData.append('profile_picture', file);\n    const token = localStorage.getItem('token');\n    try {\n      const response = await fetch('http://localhost:3000/upload_profile_picture', {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        },\n        body: formData\n      });\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`);\n      }\n      const data = await response.json();\n      console.log('Profile picture updated:', data);\n      setMessage('Profile picture updated successfully.');\n\n      // Re-fetch the profile picture\n      await fetchProfilePicture();\n    } catch (error) {\n      console.error('Error updating profile picture:', error);\n      setMessage('Failed to update profile picture.');\n    }\n  };\n  const fetchProfilePicture = async () => {\n    const token = localStorage.getItem('token');\n    try {\n      const response = await fetch('http://localhost:3000/profile_picture', {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`);\n      }\n      const data = await response.json();\n      setProfilePicture(data.profile_picture);\n    } catch (error) {\n      console.error('Error fetching profile picture:', error);\n    }\n  };\n  useEffect(() => {\n    fetchProfilePicture();\n  }, []);\n  useEffect(() => {\n    // This useEffect will run whenever profilePicture changes\n    if (profilePicture) {\n      console.log('Profile picture updated:', profilePicture);\n    }\n  }, [profilePicture]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"profile-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"profile-header-wrapper\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"profile-header\",\n        children: [!isLoading && /*#__PURE__*/_jsxDEV(\"img\", {\n          src: profilePicture,\n          alt: `${username}'s profile`,\n          className: \"profile-profile-picture\",\n          onError: e => {\n            e.target.onerror = null;\n            e.target.src = '/default-avatar.png';\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 533,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"profile-info\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"profile-top\",\n            children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n              className: \"profile-username\",\n              children: username\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 545,\n              columnNumber: 29\n            }, this), user && user.id === parseInt(id) && /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"profile-edit-btn\",\n              onClick: () => setIsEditing(true),\n              children: \"Edit Profile\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 547,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 544,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"profile-stats\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"stat-item\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"stat-number\",\n                children: \"0\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 555,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"stat-label\",\n                children: \"Following\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 556,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 554,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"stat-item\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"stat-number\",\n                children: \"0\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 559,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"stat-label\",\n                children: \"Followers\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 560,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 558,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"stat-item\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"stat-number\",\n                children: \"0\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 563,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"stat-label\",\n                children: \"Likes\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 564,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 562,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 553,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"profile-bio\",\n            children: bio\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 568,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 543,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 531,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 530,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"profile-tabs\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"tab-btn active\",\n        children: \"Posts\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 575,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"tab-btn\",\n        children: \"Likes\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 576,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"tab-btn\",\n        children: \"Tagged\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 577,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 574,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"profile-grid\",\n      children: images.map(image => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"profile-item\",\n        onClick: () => debouncedOpenModal(image),\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: image.image_url,\n          alt: image.prompt\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 588,\n          columnNumber: 25\n        }, this)\n      }, image.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 583,\n        columnNumber: 21\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 581,\n      columnNumber: 13\n    }, this), modalImage && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"profile-modal\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"profile-modal-content\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"profile-modal-main\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"profile-modal-image-container\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"profile-close-button\",\n              onClick: closeModal,\n              children: \"\\xD7\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 598,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"profile-nav-button profile-prev\",\n              onClick: () => navigateImage(-1),\n              children: /*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"\\u2039\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 600,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 599,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n              className: \"profile-modal-image\",\n              src: modalImage.image_url,\n              alt: \"Enlarged\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 602,\n              columnNumber: 33\n            }, this), isAdmin && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"profile-delete-section\",\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"profile-delete-button\",\n                onClick: handleDeleteImage,\n                children: \"Delete Image\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 605,\n                columnNumber: 41\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 604,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"profile-nav-button profile-next\",\n              onClick: () => navigateImage(1),\n              children: /*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"\\u203A\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 611,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 610,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 597,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"profile-modal-info\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"profile-modal-title\",\n              children: (_images$find = images.find(img => img.id === activeImageId)) === null || _images$find === void 0 ? void 0 : _images$find.prompt\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 615,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"profile-likes-section\",\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                className: `profile-like-button ${userLikedImages.has(activeImageId) ? 'liked' : ''}`,\n                onClick: handleLike,\n                children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                  className: `profile-like-heart ${userLikedImages.has(activeImageId) ? 'liked' : ''}`,\n                  viewBox: \"0 0 24 24\",\n                  children: /*#__PURE__*/_jsxDEV(\"path\", {\n                    d: \"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 627,\n                    columnNumber: 45\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 623,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"profile-like-count\",\n                  children: likes[activeImageId] || 0\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 629,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 619,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 618,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"profile-comments-section\",\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                className: \"profile-comments-heading\",\n                children: \"Comments\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 636,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n                className: \"profile-comments-list\",\n                children: (comments[activeImageId] || []).map(comment => /*#__PURE__*/_jsxDEV(\"li\", {\n                  className: \"profile-comment-item\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"profile-comment-avatar\",\n                    children: /*#__PURE__*/_jsxDEV(\"img\", {\n                      src: comment.profile_picture ? `http://localhost:3000/${comment.profile_picture}` : '/default-avatar.png',\n                      alt: comment.username,\n                      onError: e => e.target.src = '/default-avatar.png'\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 641,\n                      columnNumber: 53\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 640,\n                    columnNumber: 49\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"profile-comment-content\",\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"profile-comment-header\",\n                      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"profile-comment-username\",\n                        onClick: () => handleUsernameClick(comment.user_id),\n                        role: \"button\",\n                        tabIndex: 0,\n                        children: comment.username\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 651,\n                        columnNumber: 57\n                      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"profile-comment-time\",\n                        children: formatTimestamp(comment.created_at)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 659,\n                        columnNumber: 57\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 650,\n                      columnNumber: 53\n                    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"profile-comment-text\",\n                      children: comment.comment\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 663,\n                      columnNumber: 53\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"profile-comment-actions\",\n                      children: /*#__PURE__*/_jsxDEV(\"button\", {\n                        className: \"profile-comment-like-btn\",\n                        onClick: () => handleCommentLike(comment.id),\n                        children: [\"\\u2665 \", commentLikes[comment.id] || 0]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 665,\n                        columnNumber: 57\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 664,\n                      columnNumber: 53\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 649,\n                    columnNumber: 49\n                  }, this)]\n                }, `comment-${comment.id}-${comment.created_at}`, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 639,\n                  columnNumber: 45\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 637,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n                onSubmit: handleCommentSubmit,\n                className: \"profile-comment-form\",\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  className: \"profile-comment-input\",\n                  type: \"text\",\n                  value: commentInput,\n                  onChange: e => setCommentInput(e.target.value),\n                  placeholder: \"Add a comment...\",\n                  required: true\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 677,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  type: \"submit\",\n                  className: \"profile-comment-submit\",\n                  children: \"Post\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 685,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 676,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 635,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 614,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 596,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 595,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 594,\n      columnNumber: 17\n    }, this), isEditing && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"profile-edit-modal\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"profile-edit-modal-content\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"profile-edit-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            className: \"profile-edit-title\",\n            children: \"Edit Profile\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 698,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"profile-edit-close\",\n            onClick: () => setIsEditing(false),\n            children: \"\\xD7\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 699,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 697,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"profile-edit-form\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"profile-picture-section\",\n            children: [/*#__PURE__*/_jsxDEV(\"img\", {\n              src: tempProfilePicture || profilePicture,\n              alt: \"Profile\",\n              className: \"profile-edit-picture\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 703,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"file\",\n              id: \"profile-picture-input\",\n              accept: \"image/*\",\n              onChange: handleProfilePictureChange,\n              style: {\n                display: 'none'\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 708,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"profile-picture-input\",\n              className: \"profile-picture-change-btn\",\n              children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                viewBox: \"0 0 24 24\",\n                children: [/*#__PURE__*/_jsxDEV(\"path\", {\n                  d: \"M12 16.5a4.5 4.5 0 100-9 4.5 4.5 0 000 9zm0-2.5a2 2 0 100-4 2 2 0 000 4z\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 720,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n                  d: \"M20 4h-3.17L15 2H9L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 14H4V6h4.05l1.83-2h4.24l1.83 2H20v12z\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 721,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 719,\n                columnNumber: 37\n              }, this), \"Change photo\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 715,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 702,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"profile-edit-field\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Username\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 728,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              value: tempUsername,\n              onChange: e => setTempUsername(e.target.value),\n              className: \"profile-edit-input\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 729,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 727,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"profile-edit-field\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Bio\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 738,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n              value: tempBio,\n              onChange: e => setTempBio(e.target.value),\n              className: \"profile-edit-input\",\n              rows: 3\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 739,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 737,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"profile-edit-actions\",\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"profile-save-btn\",\n              onClick: handleSubmit,\n              disabled: loading,\n              children: loading ? 'Saving...' : 'Save'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 748,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 747,\n            columnNumber: 29\n          }, this), message && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"profile-message\",\n            children: message\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 758,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 701,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 696,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 695,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 529,\n    columnNumber: 9\n  }, this);\n};\n_s(Profile, \"PS1w6YWrY26I0h7C3Zpk/D1P+UM=\", false, function () {\n  return [useParams, useAuth, useProfile, useNavigate];\n});\n_c = Profile;\nexport default Profile;\nvar _c;\n$RefreshReg$(_c, \"Profile\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","jwtDecode","useParams","useNavigate","useAuth","useProfile","debounce","jsxDEV","_jsxDEV","Profile","_s","_images$find","id","user","profilePicture","setProfilePicture","username","setUsername","bio","setBio","posts","setPosts","loading","setLoading","message","setMessage","isEditing","setIsEditing","images","setImages","modalImage","setModalImage","activeImageId","setActiveImageId","likes","setLikes","comments","setComments","commentInput","setCommentInput","userLikedImages","setUserLikedImages","Set","commentLikes","setCommentLikes","modalOpen","setModalOpen","tempUsername","setTempUsername","tempBio","setTempBio","tempProfilePicture","setTempProfilePicture","profilePictureFile","setProfilePictureFile","navigate","isLoading","setIsLoading","file","setFile","debouncedOpenModal","image","console","log","fetchImageDetails","fetchUserProfile","fetchUserImages","token","localStorage","getItem","loggedInUserId","targetUserId","response","fetch","headers","ok","Error","status","data","json","error","profile_picture","baseUrl","picturePath","startsWith","profilePicUrl","imageId","likeResponse","likeData","prev","userHasLiked","add","commentResponse","commentData","handleProfilePictureChange","e","target","files","reader","FileReader","onloadend","result","readAsDataURL","handleSubmit","preventDefault","method","body","JSON","stringify","formData","FormData","append","picResponse","picData","profilePicturePath","handleCommentLike","commentId","handleCommentSubmit","decoded","userId","Authorization","comment","commentsResponse","commentsData","closeModal","navigateImage","direction","currentIndex","findIndex","img","newIndex","length","isAdmin","role","handleDeleteImage","filter","handleLike","hasLiked","has","newSet","delete","formatTimestamp","timestamp","date","Date","toLocaleString","handleUsernameClick","user_id","constructProfilePicUrl","path","isMounted","handleFileChange","handleUpload","fetchProfilePicture","className","children","src","alt","onError","onerror","fileName","_jsxFileName","lineNumber","columnNumber","parseInt","onClick","map","image_url","prompt","find","viewBox","d","tabIndex","created_at","onSubmit","type","value","onChange","placeholder","required","accept","style","display","htmlFor","rows","disabled","_c","$RefreshReg$"],"sources":["/Users/jack/image-generator/client/src/pages/Profile.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport { jwtDecode } from 'jwt-decode'; // Ensure jwt-decode is installed\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { useAuth } from '../context/AuthContext';\nimport { useProfile } from '../context/ProfileContext';\nimport debounce from 'lodash.debounce';\nimport './Profile.css';\n\nconst Profile = () => {\n    const { id } = useParams();\n    const { user } = useAuth();\n    const { profilePicture, setProfilePicture } = useProfile();\n    const [username, setUsername] = useState('');\n    const [bio, setBio] = useState('');\n    const [posts, setPosts] = useState([]);\n    const [loading, setLoading] = useState(false);\n    const [message, setMessage] = useState('');\n    const [isEditing, setIsEditing] = useState(false);\n    const [images, setImages] = useState([]);\n    const [modalImage, setModalImage] = useState(null);\n    const [activeImageId, setActiveImageId] = useState(null);\n    const [likes, setLikes] = useState({});\n    const [comments, setComments] = useState({});\n    const [commentInput, setCommentInput] = useState('');\n    const [userLikedImages, setUserLikedImages] = useState(new Set());\n    const [commentLikes, setCommentLikes] = useState({});\n    const [modalOpen, setModalOpen] = useState(false);\n    const [tempUsername, setTempUsername] = useState('');\n    const [tempBio, setTempBio] = useState('');\n    const [tempProfilePicture, setTempProfilePicture] = useState(null);\n    const [profilePictureFile, setProfilePictureFile] = useState(null);\n    const navigate = useNavigate();\n    const [isLoading, setIsLoading] = useState(true);\n    const [file, setFile] = useState(null);\n\n    const debouncedOpenModal = useCallback(\n        debounce((image) => {\n            console.log('Opening modal for image ID:', image.id);\n            setModalImage(image); // Add this line\n            setActiveImageId(image.id);\n            setModalOpen(true);\n            fetchImageDetails(image.id);\n        }, 300),\n        []\n    );\n\n    // Add debug logs\n    useEffect(() => {\n        console.log('Modal state:', { modalOpen, modalImage, activeImageId });\n    }, [modalOpen, modalImage, activeImageId]);\n\n    useEffect(() => {\n        // Fetch user bio and posts\n        fetchUserProfile();\n    }, [id]);\n\n    useEffect(() => {\n        // Initialize temp values when entering edit mode\n        if (isEditing) {\n            setTempUsername(username);\n            setTempBio(bio);\n            setTempProfilePicture(profilePicture);\n            setProfilePictureFile(null);\n            setMessage(''); // Clear message when opening modal\n        }\n    }, [isEditing]);\n\n    useEffect(() => {\n        const fetchUserImages = async () => {\n            try {\n                const token = localStorage.getItem('token');\n                const loggedInUserId = localStorage.getItem('userId');\n                \n                // If viewing own profile use localStorage userId, otherwise use URL id\n                const targetUserId = id === loggedInUserId ? loggedInUserId : id;\n                \n                console.log('Fetching images for user:', targetUserId);\n                \n                const response = await fetch(`http://localhost:3000/user_images/${targetUserId}`, {\n                    headers: {\n                        'Authorization': `Bearer ${token}`\n                    }\n                });\n\n                if (!response.ok) {\n                    throw new Error(`HTTP error! status: ${response.status}`);\n                }\n                \n                const data = await response.json();\n                console.log('Received images:', data);\n                setImages(data.images || []);\n            } catch (error) {\n                console.error('Error fetching images:', error);\n            }\n        };\n\n        fetchUserImages();\n    }, [id]); // Add id as dependency to re-fetch when URL changes\n\n    const fetchUserProfile = async () => {\n        if (!id) return;\n        \n        try {\n            console.log('Starting profile fetch for ID:', id);\n            const token = localStorage.getItem('token');\n            const response = await fetch(`http://localhost:3000/user_profile/${id}`, {\n                headers: { 'Authorization': `Bearer ${token}` }\n            });\n            \n            const data = await response.json();\n            console.log('Profile data received:', data);\n            \n            setUsername(data.username);\n            setBio(data.bio || '');\n            \n            // Standardize URL construction\n            if (data.profile_picture) {\n                const baseUrl = 'http://localhost:3000';\n                const picturePath = data.profile_picture.startsWith('/') \n                    ? data.profile_picture \n                    : `/${data.profile_picture}`;\n                const profilePicUrl = `${baseUrl}${picturePath}`;\n                \n                console.log('Constructed profile picture URL:', profilePicUrl);\n                console.log('Does file exist at path:', data.profile_picture);\n                setProfilePicture(profilePicUrl);\n            }\n            \n        } catch (error) {\n            console.error('Error fetching profile:', error);\n            setProfilePicture('/default-avatar.png');\n        }\n    };\n\n    const fetchImageDetails = async (imageId) => {\n        const token = localStorage.getItem('token');\n        if (!token) return;\n    \n        try {\n            const likeResponse = await fetch(`http://localhost:3000/fetch_likes?id=${imageId}`, {\n                headers: {\n                    'Authorization': `Bearer ${token}`\n                }\n            });\n            if (likeResponse.ok) {\n                const likeData = await likeResponse.json();\n                setLikes((prev) => ({ ...prev, [imageId]: likeData.likes || 0 }));\n                if (likeData.userHasLiked) {\n                    setUserLikedImages((prev) => new Set(prev).add(imageId));\n                }\n            }\n    \n            const commentResponse = await fetch(`http://localhost:3000/fetch_comments?id=${imageId}`, {\n                headers: {\n                    'Authorization': `Bearer ${token}` \n                }\n            });\n            if (commentResponse.ok) {\n                const commentData = await commentResponse.json();\n                // Comments should now include profile_picture from backend\n                setComments((prev) => ({ ...prev, [imageId]: commentData.comments || [] }));\n            }\n        } catch (error) {\n            console.error('Error fetching image details:', error);\n        }\n    };\n\n    const handleProfilePictureChange = async (e) => {\n        const file = e.target.files[0];\n        if (file) {\n            setProfilePictureFile(file);\n            const reader = new FileReader();\n            reader.onloadend = () => {\n                setTempProfilePicture(reader.result);\n            };\n            reader.readAsDataURL(file);\n        }\n    };\n\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n        setLoading(true);\n        setMessage('');\n\n        try {\n            const token = localStorage.getItem('token');\n            const response = await fetch('http://localhost:3000/update_profile', {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                    'Authorization': `Bearer ${token}`\n                },\n                body: JSON.stringify({ username: tempUsername, bio: tempBio })\n            });\n\n            const data = await response.json();\n            console.log('Server response:', data);\n\n            if (!response.ok) {\n                throw new Error(data.error || 'Failed to update profile');\n            }\n\n            setUsername(data.data.username);\n            setBio(data.data.bio || '');\n\n            if (profilePictureFile) {\n                const formData = new FormData();\n                formData.append('image', profilePictureFile);\n\n                const picResponse = await fetch('http://localhost:3000/upload_profile_picture', {\n                    method: 'POST',\n                    headers: { 'Authorization': `Bearer ${token}` },\n                    body: formData\n                });\n\n                const picData = await picResponse.json();\n                if (!picResponse.ok) {\n                    throw new Error(picData.error || 'Failed to upload profile picture');\n                }\n                setProfilePicture(`http://localhost:3000/${picData.profilePicturePath}`);\n            }\n\n            // Confirm changes from DB\n            await fetchUserProfile();\n            setIsEditing(false);\n            setMessage('Profile updated successfully');\n        } catch (error) {\n            console.error('Profile update error:', error);\n            setMessage(error.message);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleCommentLike = async (commentId) => {\n        const token = localStorage.getItem('token');\n        if (!token) return;\n    \n        try {\n            const response = await fetch('http://localhost:3000/like_comment', {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                    'Authorization': `Bearer ${token}`\n                },\n                body: JSON.stringify({ commentId })\n            });\n    \n            if (response.ok) {\n                setCommentLikes(prev => ({\n                    ...prev,\n                    [commentId]: !prev[commentId]\n                }));\n            }\n        } catch (error) {\n            console.error('Error liking comment:', error);\n        }\n    };\n    \n\n    \n        // Update comment state when adding new comment\n        const handleCommentSubmit = async (e) => {\n            e.preventDefault();\n            const token = localStorage.getItem('token');\n            if (!token) return;\n        \n            try {\n                const decoded = jwtDecode(token);\n                const userId = decoded.userId;\n        \n                // Post the new comment\n                const response = await fetch('http://localhost:3000/add_comment', {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                        Authorization: `Bearer ${token}`,\n                    },\n                    body: JSON.stringify({ userId, imageId: activeImageId, comment: commentInput }),\n                });\n        \n                if (response.ok) {\n                    // After adding the comment, fetch all comments again\n                    const commentsResponse = await fetch(`http://localhost:3000/fetch_comments?id=${activeImageId}`, {\n                        headers: {\n                            Authorization: `Bearer ${token}`,\n                        },\n                    });\n        \n                    if (commentsResponse.ok) {\n                        const commentsData = await commentsResponse.json();\n                        // Update comments state with the latest comments\n                        setComments((prev) => ({\n                            ...prev,\n                            [activeImageId]: commentsData.comments, // Use the fetched comments\n                        }));\n                        setCommentInput(''); // Clear the comment input\n                    } else {\n                        console.error('Error fetching comments:', await commentsResponse.json());\n                    }\n                } else {\n                    console.error('Error adding comment:', await response.json());\n                }\n            } catch (error) {\n                console.error('Error adding comment:', error);\n            }\n        };\n\n    const closeModal = () => {\n        setModalOpen(false);\n        setModalImage(null);\n        setActiveImageId(null);\n    };\n\n    const navigateImage = (direction) => {\n        const currentIndex = images.findIndex(img => img.id === activeImageId);\n        const newIndex = (currentIndex + direction + images.length) % images.length;\n        setActiveImageId(images[newIndex].id);\n        setModalImage(images[newIndex]);\n        fetchImageDetails(images[newIndex].id);\n    };\n\n    const isAdmin = user && user.role === 'admin';\n\n    const handleDeleteImage = async () => {\n        const token = localStorage.getItem('token');\n        if (!token) return;\n\n        try {\n            const response = await fetch(`http://localhost:3000/delete_image/${activeImageId}`, {\n                method: 'DELETE',\n                headers: {\n                    'Authorization': `Bearer ${token}`\n                }\n            });\n\n            if (response.ok) {\n                setImages(images.filter(img => img.id !== activeImageId));\n                closeModal();\n            } else {\n                console.error('Failed to delete image');\n            }\n        } catch (error) {\n            console.error('Error deleting image:', error);\n        }\n    };\n\n    const handleLike = async () => {\n        const token = localStorage.getItem('token');\n        if (!token) return;\n\n        const userId = jwtDecode(token).userId;\n        const hasLiked = userLikedImages.has(activeImageId);\n\n        try {\n            const response = hasLiked \n                ? await fetch('http://localhost:3000/remove_like', {\n                    method: 'DELETE',\n                    headers: {\n                        'Content-Type': 'application/json',\n                        Authorization: `Bearer ${token}`,\n                    },\n                    body: JSON.stringify({ userId, imageId: activeImageId }),\n                })\n                : await fetch('http://localhost:3000/add_like', {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                        Authorization: `Bearer ${token}`,\n                    },\n                    body: JSON.stringify({ userId, imageId: activeImageId }),\n                });\n\n            if (response.ok) {\n                if (hasLiked) {\n                    setLikes((prev) => ({\n                        ...prev,\n                        [activeImageId]: (prev[activeImageId] || 0) - 1,\n                    }));\n                    setUserLikedImages((prev) => {\n                        const newSet = new Set(prev);\n                        newSet.delete(activeImageId);\n                        return newSet;\n                    });\n                } else {\n                    setLikes((prev) => ({\n                        ...prev,\n                        [activeImageId]: (prev[activeImageId] || 0) + 1,\n                    }));\n                    setUserLikedImages((prev) => new Set(prev).add(activeImageId));\n                }\n            }\n        } catch (error) {\n            console.error('Error toggling like:', error);\n        }\n    };\n\n    const formatTimestamp = (timestamp) => {\n        const date = new Date(timestamp);\n        return date.toLocaleString();\n    };\n\n    // Add handler function\n    const handleUsernameClick = (user_id) => {\n        setModalImage(null); // Close modal\n        setModalOpen(false); // Reset modal state\n        navigate(`/profile/${user_id}`);\n    };\n\n    const constructProfilePicUrl = (path) => {\n        if (!path) return '/default-avatar.png';\n        const baseUrl = 'http://localhost:3000';\n        const picturePath = path.startsWith('/') ? path : `/${path}`;\n        return `${baseUrl}${picturePath}`;\n    };\n\n    // Add loading state\n    useEffect(() => {\n        let isMounted = true;\n        \n        const fetchUserProfile = async () => {\n            if (!id) return;\n            \n            try {\n                setIsLoading(true);\n                const token = localStorage.getItem('token');\n                const response = await fetch(`http://localhost:3000/user_profile/${id}`, {\n                    headers: { 'Authorization': `Bearer ${token}` }\n                });\n                \n                const data = await response.json();\n                console.log('Profile data received:', data);\n                \n                if (!isMounted) return;\n\n                setUsername(data.username);\n                setBio(data.bio || '');\n                \n                const profilePicUrl = constructProfilePicUrl(data.profile_picture);\n                console.log('Setting final profile picture URL:', profilePicUrl);\n                setProfilePicture(profilePicUrl);\n                \n            } catch (error) {\n                console.error('Error fetching profile:', error);\n                if (isMounted) setProfilePicture('/default-avatar.png');\n            } finally {\n                if (isMounted) setIsLoading(false);\n            }\n        };\n\n        fetchUserProfile();\n        \n        return () => {\n            isMounted = false;\n        };\n    }, [id]);\n\n    const handleFileChange = (e) => {\n        setFile(e.target.files[0]);\n    };\n\n    const handleUpload = async () => {\n        if (!file) {\n            setMessage('Please select a file to upload.');\n            return;\n        }\n\n        const formData = new FormData();\n        formData.append('profile_picture', file);\n\n        const token = localStorage.getItem('token');\n        try {\n            const response = await fetch('http://localhost:3000/upload_profile_picture', {\n                method: 'POST',\n                headers: {\n                    'Authorization': `Bearer ${token}`\n                },\n                body: formData\n            });\n\n            if (!response.ok) {\n                throw new Error(`HTTP error! status: ${response.status}`);\n            }\n\n            const data = await response.json();\n            console.log('Profile picture updated:', data);\n            setMessage('Profile picture updated successfully.');\n\n            // Re-fetch the profile picture\n            await fetchProfilePicture();\n        } catch (error) {\n            console.error('Error updating profile picture:', error);\n            setMessage('Failed to update profile picture.');\n        }\n    };\n\n    const fetchProfilePicture = async () => {\n        const token = localStorage.getItem('token');\n        try {\n            const response = await fetch('http://localhost:3000/profile_picture', {\n                headers: {\n                    'Authorization': `Bearer ${token}`\n                }\n            });\n\n            if (!response.ok) {\n                throw new Error(`HTTP error! status: ${response.status}`);\n            }\n\n            const data = await response.json();\n            setProfilePicture(data.profile_picture);\n        } catch (error) {\n            console.error('Error fetching profile picture:', error);\n        }\n    };\n\n    useEffect(() => {\n        fetchProfilePicture();\n    }, []);\n\n    useEffect(() => {\n        // This useEffect will run whenever profilePicture changes\n        if (profilePicture) {\n            console.log('Profile picture updated:', profilePicture);\n        }\n    }, [profilePicture]);\n\n    return (\n        <div className=\"profile-container\">\n            <div className=\"profile-header-wrapper\">\n                <div className=\"profile-header\">\n                    {!isLoading && (\n                        <img \n                            src={profilePicture} \n                            alt={`${username}'s profile`}\n                            className=\"profile-profile-picture\" \n                            onError={(e) => {\n                                e.target.onerror = null;\n                                e.target.src = '/default-avatar.png';\n                            }}\n                        />\n                    )}\n                    <div className=\"profile-info\">\n                        <div className=\"profile-top\">\n                            <h1 className=\"profile-username\">{username}</h1>\n                            {user && user.id === parseInt(id) && (\n                                <button className=\"profile-edit-btn\" onClick={() => setIsEditing(true)}>\n                                    Edit Profile\n                                </button>\n                            )}\n                        </div>\n                        \n                        <div className=\"profile-stats\">\n                            <div className=\"stat-item\">\n                                <span className=\"stat-number\">0</span>\n                                <span className=\"stat-label\">Following</span>\n                            </div>\n                            <div className=\"stat-item\">\n                                <span className=\"stat-number\">0</span>\n                                <span className=\"stat-label\">Followers</span>\n                            </div>\n                            <div className=\"stat-item\">\n                                <span className=\"stat-number\">0</span>\n                                <span className=\"stat-label\">Likes</span>\n                            </div>\n                        </div>\n                        \n                        <p className=\"profile-bio\">{bio}</p>\n                    </div>\n                </div>\n            </div>\n\n            {/* Add Tabs */}\n            <div className=\"profile-tabs\">\n                <button className=\"tab-btn active\">Posts</button>\n                <button className=\"tab-btn\">Likes</button>\n                <button className=\"tab-btn\">Tagged</button>\n            </div>\n\n            {/* Keep existing grid */}\n            <div className=\"profile-grid\">\n                {images.map((image) => (\n                    <div \n                        key={image.id} \n                        className=\"profile-item\"\n                        onClick={() => debouncedOpenModal(image)}\n                    >\n                        <img src={image.image_url} alt={image.prompt} />\n                    </div>\n                ))}\n            </div>\n\n            {modalImage && (\n                <div className=\"profile-modal\">\n                    <div className=\"profile-modal-content\">\n                        <div className=\"profile-modal-main\">\n                            <div className=\"profile-modal-image-container\">\n                                <button className=\"profile-close-button\" onClick={closeModal}></button>\n                                <button className=\"profile-nav-button profile-prev\" onClick={() => navigateImage(-1)}>\n                                    <span></span>\n                                </button>\n                                <img className=\"profile-modal-image\" src={modalImage.image_url} alt=\"Enlarged\" />\n                                {isAdmin && (\n                                    <div className=\"profile-delete-section\">\n                                        <button className=\"profile-delete-button\" onClick={handleDeleteImage}>\n                                            Delete Image\n                                        </button>\n                                    </div>\n                                )}\n                                <button className=\"profile-nav-button profile-next\" onClick={() => navigateImage(1)}>\n                                    <span></span>\n                                </button>\n                            </div>\n                            <div className=\"profile-modal-info\">\n                                <div className=\"profile-modal-title\">\n                                    {images.find((img) => img.id === activeImageId)?.prompt}\n                                </div>\n                                <div className=\"profile-likes-section\">\n                                    <button \n                                        className={`profile-like-button ${userLikedImages.has(activeImageId) ? 'liked' : ''}`}\n                                        onClick={handleLike}\n                                    >\n                                        <svg \n                                            className={`profile-like-heart ${userLikedImages.has(activeImageId) ? 'liked' : ''}`} \n                                            viewBox=\"0 0 24 24\"\n                                        >\n                                            <path d=\"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z\" />\n                                        </svg>\n                                        <span className=\"profile-like-count\">\n                                            {likes[activeImageId] || 0}\n                                        </span>\n                                    </button>\n                                </div>\n\n                                <div className=\"profile-comments-section\">\n                                    <h4 className=\"profile-comments-heading\">Comments</h4>\n                                    <ul className=\"profile-comments-list\">\n                                        {(comments[activeImageId] || []).map((comment) => (\n                                            <li key={`comment-${comment.id}-${comment.created_at}`} className=\"profile-comment-item\">\n                                                <div className=\"profile-comment-avatar\">\n                                                    <img \n                                                        src={comment.profile_picture ? \n                                                            `http://localhost:3000/${comment.profile_picture}` : \n                                                            '/default-avatar.png'} \n                                                        alt={comment.username}\n                                                        onError={(e) => e.target.src = '/default-avatar.png'}\n                                                    />\n                                                </div>\n                                                <div className=\"profile-comment-content\">\n                                                    <div className=\"profile-comment-header\">\n                                                        <span \n                                                            className=\"profile-comment-username\"\n                                                            onClick={() => handleUsernameClick(comment.user_id)}\n                                                            role=\"button\"\n                                                            tabIndex={0}\n                                                        >\n                                                            {comment.username}\n                                                        </span>\n                                                        <span className=\"profile-comment-time\">\n                                                            {formatTimestamp(comment.created_at)}\n                                                        </span>\n                                                    </div>\n                                                    <p className=\"profile-comment-text\">{comment.comment}</p>\n                                                    <div className=\"profile-comment-actions\">\n                                                        <button \n                                                            className=\"profile-comment-like-btn\"\n                                                            onClick={() => handleCommentLike(comment.id)}\n                                                        >\n                                                             {commentLikes[comment.id] || 0}\n                                                        </button>\n                                                    </div>\n                                                </div>\n                                            </li>\n                                        ))}\n                                    </ul>\n                                    <form onSubmit={handleCommentSubmit} className=\"profile-comment-form\">\n                                        <input\n                                            className=\"profile-comment-input\"\n                                            type=\"text\"\n                                            value={commentInput}\n                                            onChange={(e) => setCommentInput(e.target.value)}\n                                            placeholder=\"Add a comment...\"\n                                            required\n                                        />\n                                        <button type=\"submit\" className=\"profile-comment-submit\">Post</button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            )}\n\n            {isEditing && (\n                <div className=\"profile-edit-modal\">\n                    <div className=\"profile-edit-modal-content\">\n                        <div className=\"profile-edit-header\">\n                            <h2 className=\"profile-edit-title\">Edit Profile</h2>\n                            <button className=\"profile-edit-close\" onClick={() => setIsEditing(false)}></button>\n                        </div>\n                        <div className=\"profile-edit-form\">\n                            <div className=\"profile-picture-section\">\n                                <img \n                                    src={tempProfilePicture || profilePicture} \n                                    alt=\"Profile\" \n                                    className=\"profile-edit-picture\" \n                                />\n                                <input\n                                    type=\"file\"\n                                    id=\"profile-picture-input\"\n                                    accept=\"image/*\"\n                                    onChange={handleProfilePictureChange}\n                                    style={{ display: 'none' }}\n                                />\n                                <label \n                                    htmlFor=\"profile-picture-input\" \n                                    className=\"profile-picture-change-btn\"\n                                >\n                                    <svg viewBox=\"0 0 24 24\">\n                                        <path d=\"M12 16.5a4.5 4.5 0 100-9 4.5 4.5 0 000 9zm0-2.5a2 2 0 100-4 2 2 0 000 4z\"/>\n                                        <path d=\"M20 4h-3.17L15 2H9L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 14H4V6h4.05l1.83-2h4.24l1.83 2H20v12z\"/>\n                                    </svg>\n                                    Change photo\n                                </label>\n                            </div>\n\n                            <div className=\"profile-edit-field\">\n                                <label>Username</label>\n                                <input\n                                    type=\"text\"\n                                    value={tempUsername}\n                                    onChange={(e) => setTempUsername(e.target.value)}\n                                    className=\"profile-edit-input\"\n                                />\n                            </div>\n\n                            <div className=\"profile-edit-field\">\n                                <label>Bio</label>\n                                <textarea\n                                    value={tempBio}\n                                    onChange={(e) => setTempBio(e.target.value)}\n                                    className=\"profile-edit-input\"\n                                    rows={3}\n                                />\n                            </div>\n\n                            <div className=\"profile-edit-actions\">\n                                <button \n                                    className=\"profile-save-btn\"\n                                    onClick={handleSubmit}\n                                    disabled={loading}\n                                >\n                                    {loading ? 'Saving...' : 'Save'}\n                                </button>\n                            </div>\n\n                            {message && (\n                                <div className=\"profile-message\">\n                                    {message}\n                                </div>\n                            )}\n                        </div>\n                    </div>\n                </div>\n            )}\n        </div>    \n    );\n};\n\nexport default Profile;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}